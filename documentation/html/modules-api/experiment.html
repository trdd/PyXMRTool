
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Module Experiment &#8212; PyXMRTool 0.9 documentation</title>
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Module Fitters" href="fitters.html" />
    <link rel="prev" title="Module SampleRepresentation" href="samplerepresentation.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="fitters.html" title="Module Fitters"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="samplerepresentation.html" title="Module SampleRepresentation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PyXMRTool 0.9 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" accesskey="U">API</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../index.html">Table of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">PyXMRTool’s documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="parameters.html">Module <cite>Parameters</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="samplerepresentation.html">Module <cite>SampleRepresentation</cite></a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Module <cite>Experiment</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="fitters.html">Module <cite>Fitters</cite></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../hints.html">Hints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../definitions.html">Terms and Definitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Developement</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="samplerepresentation.html"
                        title="previous chapter">Module <cite>SampleRepresentation</cite></a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="fitters.html"
                        title="next chapter">Module <cite>Fitters</cite></a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/modules-api/experiment.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-Experiment">
<span id="module-experiment"></span><h1>Module <cite>Experiment</cite><a class="headerlink" href="#module-Experiment" title="Permalink to this headline">¶</a></h1>
<p>Deals with the description of the experiment and brings experimental and simulated data together.
It contains currently only the class <a class="reference internal" href="#Experiment.ReflDataSimulator" title="Experiment.ReflDataSimulator"><code class="xref py py-class docutils literal notranslate"><span class="pre">ReflDataSimulator</span></code></a>, which does this job.</p>
<dl class="class">
<dt id="Experiment.ReflDataSimulator">
<em class="property">class </em><code class="descclassname">Experiment.</code><code class="descname">ReflDataSimulator</code><span class="sig-paren">(</span><em>mode</em>, <em>length_scale=1e-09</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Experiment.html#ReflDataSimulator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Experiment.ReflDataSimulator" title="Permalink to this definition">¶</a></dt>
<dd><p>Holds the experimental data, simulates it according to the settings and fitparameters and can directly deliver the sum of squared residuals (<a class="reference internal" href="#Experiment.ReflDataSimulator.getSSR" title="Experiment.ReflDataSimulator.getSSR"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getSSR()</span></code></a>) and the residuals themselfs (<a class="reference internal" href="#Experiment.ReflDataSimulator.getResidualsSSR" title="Experiment.ReflDataSimulator.getResidualsSSR"><code class="xref py py-meth docutils literal notranslate"><span class="pre">getResidualsSSR()</span></code></a>), which both describe the difference between data and simulation at a certain parameter set. It can be in different modes which determins which data or which derived data is stored and simulated.</p>
<dl class="method">
<dt id="Experiment.ReflDataSimulator.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>mode</em>, <em>length_scale=1e-09</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Experiment.html#ReflDataSimulator.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Experiment.ReflDataSimulator.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the ReflDataSimulator with a certain mode.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mode</strong> (<em>string</em>) – <p>The following modes are implemented so far:</p>
<ul>
<li>’l’             - for linear polarized light, only reflectivity for sigma and pi polarization will be stored and simulated</li>
<li>’c’             - for circular polarized light, only reflectivity for left circular and right circular polarization will be stored and simulated</li>
<li>’t’             - only the total reflectivity (sum of reflectivities of different polarizations l/r or sigma/pi) will be stored and simulated (contains only structural information)</li>
<li>’x’             - for xmcd, only the difference between the reflectivity for right circular and left circular polarization will be stored and simulated (contains only magnetic information). Actually, it is the normalized XMCD or asymmetry <em>(rleft-rright)/(rleft+rright)</em>.</li>
<li>’cx&lt;xfactor&gt;’   - for the reflections of circular pol. light and the xmcd signal (which should usually been calculated from the left and right circ. pol.) simultaniously ‘&lt;xfactor&gt;’ is optional and can be used to multiply the xmcd signal with this value. This can be usefull to give the xmcd more or less weight during fitting e.g.’cx20’ or ‘cx0.1’</li>
<li>’lL’, ‘cL’, ‘tL’, ‘xL’, ‘cLx&lt;xfactor&gt;’, - as before, but instead of the corresponding reflectivities (or derived values) themselfs their logarithms are stored and simulated. This is usefull for fitting as with the logarithm the errors of different data points are weighted in a comparable way, in spite of the strongly decaying intensitiy for higher angles (see J.Pyhs.: Condens. Matter 26 (2014) 363201, page 16).</li>
</ul>
</li>
<li><strong>length_scale</strong> (<em>float</em>) – Defines in which unit lengths are measured in your script. The unit is then <strong>length_scale</strong> * meters. Default is <strong>length_scale</strong> = <em>1e-9</em> which means <em>nm</em>. It is important to define it here due to conversion between energies and wavelength.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Experiment.ReflDataSimulator.ReadData">
<code class="descname">ReadData</code><span class="sig-paren">(</span><em>files</em>, <em>linereaderfunction</em>, <em>energies=None</em>, <em>angles=None</em>, <em>filenamereaderfunction=None</em>, <em>pointmodifierfunction=None</em>, <em>headerlines=0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Experiment.html#ReflDataSimulator.ReadData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Experiment.ReflDataSimulator.ReadData" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the data files and store the data corresponding to the <strong>mode</strong> specified with instanciation (see <a class="reference internal" href="#Experiment.ReflDataSimulator.__init__" title="Experiment.ReflDataSimulator.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ReflDataSimulator.__init__()</span></code></a>)</p>
<p>This function enables a very flexible reading of the data files.
Logically, this function uses data points which consist of the independent variables energy and angle, and the reflectivities as dependent variables (rsigma,rpi,rleft,rright,xmcd,total).
So one point is specified by (energy,angle,rsigmag,rpi,rleft,rright,xmcd,total)  with energies in eV and angles in degrees.
Where the values for the independent variables comes from can differ: either from lists (<strong>energies</strong>, <strong>angles</strong>), from the filenames (<strong>filenamereaderfunction</strong>) or from the lines in the data file (<strong>linereaderfunction</strong>).</p>
<p>The function allows for multiple data reads. Each execution adds new data to the already stored one.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>files</strong> (<em>str</em><em> or </em><em>list of str</em>) – Specifies the set of data files. Either a list of filenames or one foldername of a folder containing all the data files (and only them!).</li>
<li><strong>linereaderfunction</strong> (<em>callable</em>) – A function given by the user which takes one line of an input file as string and returns a list/tuple of real numbers <em>(energy,angle,rsigma,rpi,rleft,rright,xmcd,total)</em>. Entries can also be ‘None’. Exceptions will only be trown if the needed information for the specified <strong>mode</strong> is not delivered. An easy way to create such a function is to use the method <a class="reference internal" href="#Experiment.ReflDataSimulator.createLinereader" title="Experiment.ReflDataSimulator.createLinereader"><code class="xref py py-meth docutils literal notranslate"><span class="pre">createLinereader()</span></code></a>.
The linereaderfunction can also return a list of lists if several datapoints are present in on line of the datafile.</li>
<li><strong>energies</strong> (<em>list of floats</em>) – Only possible to be different from <em>None</em> if <strong>files</strong> is a list of filenames and <strong>angles</strong> is <cite>None</cite>. Gives the energies which belong to the corresponding files (same order) as floats.</li>
<li><strong>angles</strong> (<em>list of floats</em>) – Only possible to be different from <em>None</em> if <strong>files</strong> is a list of filenames and <strong>energies</strong> is <cite>None</cite>. Gives the angles which belong to the corresponding files (same order) as floats.</li>
<li><strong>filenamereaderfunction</strong> (<em>callable</em>) – A user-defined function which reads energies and/or angles from the filenames of the data files. This function should take a string (a filename without path), extract energy and/or angle out of it and return this as a tuple/list <em>(energy,angle)</em>. Both entries can also be set to <em>None</em>, but their will be an exception if the needed information for the data points can also not be obtained from the <strong>linereaderfunction</strong>.</li>
<li><strong>pointmodifierfunction</strong> (<em>callable</em>) – A user-definde function which is used to modify the obtained information. It takes the tuple/list of independent and dependent variables of a single data point and returns a modified one. It can be used for example if the data file contains qz values instead of angles. In this case you can read the qz values first as angles and replace them afterwards with the angles calculated out of it with the <strong>pointmodifierfunction</strong>. Of course you can also use a adopted <strong>linereaderfunction</strong> for this purpose (if all necessary information can be found in one line of the data files).</li>
<li><strong>headerlines</strong> (<em>int</em>) – specifies the number of lines which should be ignored at the top of each file.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Experiment.ReflDataSimulator.setData">
<code class="descname">setData</code><span class="sig-paren">(</span><em>datapoints</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Experiment.html#ReflDataSimulator.setData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Experiment.ReflDataSimulator.setData" title="Permalink to this definition">¶</a></dt>
<dd><p>Store the data given with <strong>datapoints</strong> corresponding to the <strong>mode</strong> specified with instanciation (see <a class="reference internal" href="#Experiment.ReflDataSimulator.__init__" title="Experiment.ReflDataSimulator.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ReflDataSimulator.__init__()</span></code></a>) instead of reading the data from data files (see <a class="reference internal" href="#Experiment.ReflDataSimulator.ReadData" title="Experiment.ReflDataSimulator.ReadData"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ReadData()</span></code></a>).</p>
<dl class="docutils">
<dt><strong>datapoints</strong> has to be a list/array of datapoints of the following form:</dt>
<dd>[[energy1,angle1,rsigma1,rpi1,rleft1,rright1,xmcd1,total1], …, [energyK,angleK,rsigmaK,rpiK,rleftK,rrightK,xmcdK,totalK]</dd>
</dl>
<p>Each datapoint corresponds to a measurement of the reflectivity at a certain angle and energy. Entries are alowed to hold <em>None</em> if the corresponding entry is not needed for current <strong>mode</strong>.</p>
<p>The function allows for multiple data reads. Each execution adds new data to the already stored one.</p>
</dd></dl>

<dl class="method">
<dt id="Experiment.ReflDataSimulator.setModel">
<code class="descname">setModel</code><span class="sig-paren">(</span><em>heterostructure</em>, <em>exp_energyshift=&lt;PyXMRTool.Parameters.Parameter object&gt;</em>, <em>exp_angleshift=&lt;PyXMRTool.Parameters.Parameter object&gt;</em>, <em>reflmodifierfunction=None</em>, <em>MultipleScattering=True</em>, <em>MagneticCutoff=1e-50</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Experiment.html#ReflDataSimulator.setModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Experiment.ReflDataSimulator.setModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Set up the model for the simulation of the reflectivity data.</p>
<p>The simulation of the reflectivities is in prinicple done by using the information about the sample stored in <strong>heterostructure</strong> (of type <a class="reference internal" href="samplerepresentation.html#SampleRepresentation.Heterostructure" title="SampleRepresentation.Heterostructure"><code class="xref py py-class docutils literal notranslate"><span class="pre">SampleRepresentation.Heterostructure</span></code></a>). But to connect the simulation with the experiment it is also important to take into account systematic errors in energy and angles and to be able to adjust the simulated reflectivities to measured ones with offset and scaling.</p>
<p>A first step concerns the independent variables energy and angles. We assume, the experiment does not measure the true quantities. Instead they measure shifted quantities: <img class="math" src="../_images/math/2f955ecd962ca19117a755b7bf8f3967ba8a39be.png" alt="E_{exp}=E_{true}+\mathrm{exp\_energyshift}"/> and <img class="math" src="../_images/math/657f90ed5919c5c772df2ca9c27371f52827bb1e.png" alt="\theta_{exp}=\theta_{true}+\mathrm{exp\_angleshift}"/>.
The simulated reflectivities will be calculated for the <em>true</em> quantities which correspond to the measured ones. (by substraction of the shifts)
<strong>exp_energyshift</strong> and <strong>exp_angleshift</strong> are measured in <em>eV</em> and <em>degrees</em> resp.</p>
<p>The calculated reflectivities are then given to the <strong>reflmodifierfunction</strong> for further modification of the reflectivity values (takes one number or numpy array and the fitpararray; returns one number or a numpy array). This function has to be defined
by the user and can be used for example to multiply the reflectivity by a global number and/or to add a common background. To make these numbers fittable, use the fitparameters registerd at an instance of <code class="xref py py-class docutils literal notranslate"><span class="pre">Paramters.ParamterPool</span></code>.
Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="n">pp</span><span class="o">=</span><span class="n">Paramters</span><span class="o">.</span><span class="n">ParameterPool</span><span class="p">(</span><span class="s2">&quot;any_parameterfile&quot;</span><span class="p">)</span>
<span class="o">...</span>
<span class="n">b</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">newParameter</span><span class="p">(</span><span class="s2">&quot;background&quot;</span><span class="p">)</span>
<span class="n">m</span><span class="o">=</span><span class="n">pp</span><span class="o">.</span><span class="n">newParameter</span><span class="p">(</span><span class="s2">&quot;multiplier&quot;</span><span class="p">)</span>
<span class="n">reflmodifierfunction</span><span class="o">=</span><span class="k">lambda</span> <span class="n">r</span><span class="p">,</span> <span class="n">fitpararray</span><span class="p">:</span> <span class="n">b</span><span class="o">.</span><span class="n">getValue</span><span class="p">(</span><span class="n">fitpararray</span><span class="p">)</span> <span class="o">+</span> <span class="n">r</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">getValue</span><span class="p">(</span><span class="n">fitpararray</span><span class="p">)</span>
</pre></div>
</div>
<p>and give this function to <a class="reference internal" href="#Experiment.ReflDataSimulator.setModel" title="Experiment.ReflDataSimulator.setModel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setModel()</span></code></a>.</p>
<p>BEWARE: The reflmodifierfunction is called very often during fitting procedures. Make it performant!</p>
<p>With <strong>MultipleScattering</strong> you can switch on (<em>True</em>) and off (<em>False</em>) the simulation of multiple scattering. <em>False</em> is 20 percent faster. Default is <em>True</em>. Has no effect on calculations that require the full matrix.</p>
<p><strong>MagneticCutoff</strong>: If an off-diagonal element of chi (chi_g) fulfills abs(chi_g)&lt;MagneticCutoff, it is set to zero. It defaults to 10e-50.</p>
<p>The last two parameters are directly passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">Pythonreflectivity.Reflectivity()</span></code>. See also the Documentation of <code class="xref py py-mod docutils literal notranslate"><span class="pre">Pythonreflectivity</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="Experiment.ReflDataSimulator.getLenDataFlat">
<code class="descname">getLenDataFlat</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Experiment.html#ReflDataSimulator.getLenDataFlat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Experiment.ReflDataSimulator.getLenDataFlat" title="Permalink to this definition">¶</a></dt>
<dd><p>Return length of the flat data representation.</p>
<p>It will be the number of measured data points times 2 for mode “l” and “c”, only the number of measured data points for mode “x” and “t”, and the number of measured data points times 3 for mode “cx”</p>
</dd></dl>

<dl class="method">
<dt id="Experiment.ReflDataSimulator.getSimData">
<code class="descname">getSimData</code><span class="sig-paren">(</span><em>fitpararray</em>, <em>energy_angles=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Experiment.html#ReflDataSimulator.getSimData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Experiment.ReflDataSimulator.getSimData" title="Permalink to this definition">¶</a></dt>
<dd><p>Return simulated data according to the bevor set-up model and the parameter values given with <strong>fitpararray</strong> (see also <a class="reference internal" href="parameters.html#module-Parameters" title="Parameters"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Parameters</span></code></a>).
Usually, the data is simulated for the energies and angles of the stored experimental data (substracted by <em>exp_energyshift</em> and <em>exp_angleshift</em>, see <a class="reference internal" href="#Experiment.ReflDataSimulator.setModel" title="Experiment.ReflDataSimulator.setModel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setModel()</span></code></a>).</p>
<p>If you specify <strong>energy_angles</strong>, then the data is simulated for the energy/angle combinations given there (also substracted by <em>exp_energyshift</em> and <em>exp_angleshift</em>, see <a class="reference internal" href="#Experiment.ReflDataSimulator.setModel" title="Experiment.ReflDataSimulator.setModel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setModel()</span></code></a>).</p>
<p><strong>energy_angles</strong> has to have the following shape:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="p">[[</span><span class="n">energy1</span><span class="p">,[</span><span class="n">angle11</span><span class="p">,</span><span class="o">....</span><span class="n">angle1N</span><span class="p">]],</span> <span class="o">...</span><span class="p">[</span><span class="n">energyL</span><span class="p">,[</span><span class="n">angleL</span><span class="p">,</span><span class="o">....</span><span class="n">angleLK</span><span class="p">]]</span>
</pre></div>
</div>
<p>The returned data is a list and has on of the following or similar shapes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="p">[[</span><span class="n">energy1</span><span class="p">,[</span><span class="n">angle1</span><span class="p">,</span><span class="o">....</span><span class="n">angleN</span><span class="p">],</span> <span class="p">[</span><span class="n">rsigma1</span><span class="p">,</span> <span class="o">....</span> <span class="n">rsigmaN</span><span class="p">],</span> <span class="p">[</span><span class="n">rpi1</span><span class="p">,</span><span class="o">...</span><span class="n">rpiN</span><span class="p">]],</span> <span class="o">...</span><span class="p">[</span><span class="n">energyL</span><span class="p">,[</span><span class="n">angle1</span><span class="p">,</span><span class="o">....</span><span class="n">angleK</span><span class="p">],</span> <span class="p">[</span><span class="n">rsigma1</span><span class="p">,</span> <span class="o">....</span> <span class="n">rsigmaK</span><span class="p">],</span> <span class="p">[</span><span class="n">rpi1</span><span class="p">,</span><span class="o">...</span><span class="n">rpiK</span><span class="p">]]</span>
<span class="p">[[</span><span class="n">energy1</span><span class="p">,[</span><span class="n">angle1</span><span class="p">,</span><span class="o">....</span><span class="n">angleN</span><span class="p">],</span> <span class="p">[</span><span class="n">rleft1</span><span class="p">,</span> <span class="o">....</span> <span class="n">rleftN</span><span class="p">],</span> <span class="p">[</span><span class="n">rright1</span><span class="p">,</span><span class="o">...</span><span class="n">rrightN</span><span class="p">]],</span> <span class="o">...</span><span class="p">[</span><span class="n">energyL</span><span class="p">,[</span><span class="n">angle1</span><span class="p">,</span><span class="o">....</span><span class="n">angleK</span><span class="p">],</span> <span class="p">[</span><span class="n">rleft1</span><span class="p">,</span> <span class="o">....</span> <span class="n">rleftK</span><span class="p">],</span> <span class="p">[</span><span class="n">rright1</span><span class="p">,</span><span class="o">...</span><span class="n">rrightK</span><span class="p">]]</span>
<span class="p">[[</span><span class="n">energy1</span><span class="p">,[</span><span class="n">angle1</span><span class="p">,</span><span class="o">....</span><span class="n">angleN</span><span class="p">],</span> <span class="p">[</span><span class="n">xmcd1</span><span class="p">,</span> <span class="o">....</span> <span class="n">xmcdN</span><span class="p">]],</span> <span class="o">...</span><span class="p">[</span><span class="n">energyL</span><span class="p">,[</span><span class="n">angle1</span><span class="p">,</span><span class="o">....</span><span class="n">angleK</span><span class="p">],</span> <span class="p">[</span><span class="n">xmcd1</span><span class="p">,</span> <span class="o">....</span> <span class="n">xmcdK</span><span class="p">]]</span>
<span class="p">[[</span><span class="n">energy1</span><span class="p">,[</span><span class="n">angle1</span><span class="p">,</span><span class="o">....</span><span class="n">angleN</span><span class="p">],</span> <span class="p">[</span><span class="n">rleft1</span><span class="p">,</span> <span class="o">....</span> <span class="n">rleftN</span><span class="p">],</span> <span class="p">[</span><span class="n">rright1</span><span class="p">,</span><span class="o">...</span><span class="n">rrightN</span><span class="p">],</span> <span class="p">[</span><span class="n">xmcd1</span><span class="p">,</span> <span class="o">....</span> <span class="n">xmcdN</span><span class="p">]]],</span> <span class="o">...</span><span class="p">[</span><span class="n">energyL</span><span class="p">,[</span><span class="n">angle1</span><span class="p">,</span><span class="o">....</span><span class="n">angleK</span><span class="p">],</span> <span class="p">[</span><span class="n">rleft1</span><span class="p">,</span> <span class="o">....</span> <span class="n">rleftK</span><span class="p">],</span> <span class="p">[</span><span class="n">rright1</span><span class="p">,</span><span class="o">...</span><span class="n">rrightK</span><span class="p">],[</span><span class="n">xmcd1</span><span class="p">,</span> <span class="o">....</span> <span class="n">xmcdK</span><span class="p">]]</span>
<span class="p">[[</span><span class="n">energy1</span><span class="p">,[</span><span class="n">angle1</span><span class="p">,</span><span class="o">....</span><span class="n">angleN</span><span class="p">],</span> <span class="p">[</span><span class="n">xmcd1</span><span class="p">,</span> <span class="o">....</span> <span class="n">xmcdN</span><span class="p">]],</span> <span class="o">...</span><span class="p">[</span><span class="n">energyL</span><span class="p">,[</span><span class="n">angle1</span><span class="p">,</span><span class="o">....</span><span class="n">angleK</span><span class="p">],</span> <span class="p">[</span><span class="n">total1</span><span class="p">,</span> <span class="o">....</span> <span class="n">totalK</span><span class="p">]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Experiment.ReflDataSimulator.getExpData">
<code class="descname">getExpData</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Experiment.html#ReflDataSimulator.getExpData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Experiment.ReflDataSimulator.getExpData" title="Permalink to this definition">¶</a></dt>
<dd><p>Return stored experimental data.</p>
<p>The retured data is a list and has on of the following or similar shapes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="p">[[</span><span class="n">energy1</span><span class="p">,[</span><span class="n">angle1</span><span class="p">,</span><span class="o">....</span><span class="n">angleN</span><span class="p">],</span> <span class="p">[</span><span class="n">rsigma1</span><span class="p">,</span> <span class="o">....</span> <span class="n">rsigmaN</span><span class="p">],</span> <span class="p">[</span><span class="n">rpi1</span><span class="p">,</span><span class="o">...</span><span class="n">rpiN</span><span class="p">]],</span> <span class="o">...</span><span class="p">[</span><span class="n">energyL</span><span class="p">,[</span><span class="n">angle1</span><span class="p">,</span><span class="o">....</span><span class="n">angleK</span><span class="p">],</span> <span class="p">[</span><span class="n">rsigma1</span><span class="p">,</span> <span class="o">....</span> <span class="n">rsigmaK</span><span class="p">],</span> <span class="p">[</span><span class="n">rpi1</span><span class="p">,</span><span class="o">...</span><span class="n">rpiK</span><span class="p">]]</span>
<span class="p">[[</span><span class="n">energy1</span><span class="p">,[</span><span class="n">angle1</span><span class="p">,</span><span class="o">....</span><span class="n">angleN</span><span class="p">],</span> <span class="p">[</span><span class="n">rleft1</span><span class="p">,</span> <span class="o">....</span> <span class="n">rleftN</span><span class="p">],</span> <span class="p">[</span><span class="n">rright1</span><span class="p">,</span><span class="o">...</span><span class="n">rrightN</span><span class="p">]],</span> <span class="o">...</span><span class="p">[</span><span class="n">energyL</span><span class="p">,[</span><span class="n">angle1</span><span class="p">,</span><span class="o">....</span><span class="n">angleK</span><span class="p">],</span> <span class="p">[</span><span class="n">rleft1</span><span class="p">,</span> <span class="o">....</span> <span class="n">rleftK</span><span class="p">],</span> <span class="p">[</span><span class="n">rright1</span><span class="p">,</span><span class="o">...</span><span class="n">rrightK</span><span class="p">]]</span>
<span class="p">[[</span><span class="n">energy1</span><span class="p">,[</span><span class="n">angle1</span><span class="p">,</span><span class="o">....</span><span class="n">angleN</span><span class="p">],</span> <span class="p">[</span><span class="n">xmcd1</span><span class="p">,</span> <span class="o">....</span> <span class="n">xmcdN</span><span class="p">]],</span> <span class="o">...</span><span class="p">[</span><span class="n">energyL</span><span class="p">,[</span><span class="n">angle1</span><span class="p">,</span><span class="o">....</span><span class="n">angleK</span><span class="p">],</span> <span class="p">[</span><span class="n">xmcd1</span><span class="p">,</span> <span class="o">....</span> <span class="n">xmcdK</span><span class="p">]]</span>
<span class="p">[[</span><span class="n">energy1</span><span class="p">,[</span><span class="n">angle1</span><span class="p">,</span><span class="o">....</span><span class="n">angleN</span><span class="p">],</span> <span class="p">[</span><span class="n">rleft1</span><span class="p">,</span> <span class="o">....</span> <span class="n">rleftN</span><span class="p">],</span> <span class="p">[</span><span class="n">rright1</span><span class="p">,</span><span class="o">...</span><span class="n">rrightN</span><span class="p">],</span> <span class="p">[</span><span class="n">xmcd1</span><span class="p">,</span> <span class="o">....</span> <span class="n">xmcdN</span><span class="p">]]],</span> <span class="o">...</span><span class="p">[</span><span class="n">energyL</span><span class="p">,[</span><span class="n">angle1</span><span class="p">,</span><span class="o">....</span><span class="n">angleK</span><span class="p">],</span> <span class="p">[</span><span class="n">rleft1</span><span class="p">,</span> <span class="o">....</span> <span class="n">rleftK</span><span class="p">],</span> <span class="p">[</span><span class="n">rright1</span><span class="p">,</span><span class="o">...</span><span class="n">rrightK</span><span class="p">],[</span><span class="n">xmcd1</span><span class="p">,</span> <span class="o">....</span> <span class="n">xmcdK</span><span class="p">]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="Experiment.ReflDataSimulator.getSSR">
<code class="descname">getSSR</code><span class="sig-paren">(</span><em>fitpararray</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Experiment.html#ReflDataSimulator.getSSR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Experiment.ReflDataSimulator.getSSR" title="Permalink to this definition">¶</a></dt>
<dd><p>Return sum of squared residuals between measured and simulated data as float according to the parameterset given by <strong>fitpararray</strong> (see also <a class="reference internal" href="parameters.html#module-Parameters" title="Parameters"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Parameters</span></code></a>).</p>
</dd></dl>

<dl class="method">
<dt id="Experiment.ReflDataSimulator.getResidualsSSR">
<code class="descname">getResidualsSSR</code><span class="sig-paren">(</span><em>fitpararray</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Experiment.html#ReflDataSimulator.getResidualsSSR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Experiment.ReflDataSimulator.getResidualsSSR" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the residuals and the sum of squared residuals between measured and simulated data according to the parameterset given by <strong>fitpararray</strong> (see also <a class="reference internal" href="parameters.html#module-Parameters" title="Parameters"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Parameters</span></code></a>).</p>
<p>The information is returned as tuple: array of differences between simulated and measured data, sum of squared residuals.</p>
</dd></dl>

<dl class="method">
<dt id="Experiment.ReflDataSimulator.getResiduals">
<code class="descname">getResiduals</code><span class="sig-paren">(</span><em>fitpararray</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Experiment.html#ReflDataSimulator.getResiduals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Experiment.ReflDataSimulator.getResiduals" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the residuals between measured and simulated data according to the parameterset given by <strong>fitpararray</strong> (see also <a class="reference internal" href="parameters.html#module-Parameters" title="Parameters"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Parameters</span></code></a>).</p>
</dd></dl>

<dl class="method">
<dt id="Experiment.ReflDataSimulator.plotData">
<code class="descname">plotData</code><span class="sig-paren">(</span><em>fitpararray</em>, <em>simcolor='r'</em>, <em>expcolor='b'</em>, <em>simlabel='simulated'</em>, <em>explabel='experimental'</em>, <em>energy_angles=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Experiment.html#ReflDataSimulator.plotData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Experiment.ReflDataSimulator.plotData" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot simulated and experimental data.</p>
<p>If <strong>energy_angles</strong> is given, it will only plot simulated data for the given energy/angle combinations.</p>
<p>This function generates a plot at the first call and refreshes it if called again.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>simcolor</strong> (<em>str</em>) – Specifies the color of the simulated data for the plotting with pyplot (see <a class="reference external" href="https://matplotlib.org/users/colors.html">https://matplotlib.org/users/colors.html</a>). Default is red.</li>
<li><strong>expcolor</strong> (str  are supposed to be strings which specify a color for the plotting with pyplot (see <a class="reference external" href="https://matplotlib.org/users/colors.html">https://matplotlib.org/users/colors.html</a>).) – Specifies the color of the experimental data for the plotting with pyplot (see <a class="reference external" href="https://matplotlib.org/users/colors.html">https://matplotlib.org/users/colors.html</a>). Default is blue.</li>
<li><strong>simlabel</strong> (<em>str</em>) – Label shown in the legend of the plot for the simulated data. Default is <em>“simulated”</em>.</li>
<li><strong>explabel</strong> (<em>str</em>) – Label shown in the legend of the plot for the experimental data. Default is <em>“experimental”</em>.</li>
<li><strong>energy_angles</strong> (<em>list</em>) – <p>If given, only simulated data will be plotted for the given energy/angle combinations.
It has to have the following shape:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span class="p">[[</span><span class="n">energy1</span><span class="p">,[</span><span class="n">angle11</span><span class="p">,</span><span class="o">....</span><span class="n">angle1N</span><span class="p">]],</span> <span class="o">...</span><span class="p">[</span><span class="n">energyL</span><span class="p">,[</span><span class="n">angleL</span><span class="p">,</span><span class="o">....</span><span class="n">angleLK</span><span class="p">]]</span>
</pre></div>
</div>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Experiment.ReflDataSimulator.setMode">
<code class="descname">setMode</code><span class="sig-paren">(</span><em>mode</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Experiment.html#ReflDataSimulator.setMode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Experiment.ReflDataSimulator.setMode" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the mode after instantiation.</p>
<p>Be carefull with this function. Errors can occur if the mode does not fit to the available information in the data files.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mode</strong> (<em>string</em>) – <p>The following modes are implemented so far:</p>
<ul class="simple">
<li>’l’             - for linear polarized light, only reflectivity for sigma and pi polarization will be stored and simulated</li>
<li>’c’             - for circular polarized light, only reflectivity for left circular and right circular polarization will be stored and simulated</li>
<li>’s‘             - only the sum of the reflectivities of left and right polarized light will be stored and simulated (contains only structural information)</li>
<li>’x’             - for xmcd, only the difference between the reflectivity for right circular and left circular polarization will be stored and simulated. Actually, it is the normalized XMCD or asymmetry <em>(rleft-rright)/(rleft+rright)</em>.</li>
<li>’cx&lt;xfactor&gt;’   - for the reflections of circular pol. light and the xmcd signal (which should usually been calculated from the left and right circ. pol.) simultaniously ‘&lt;xfactor&gt;’ is optional and can be used to multiply the xmcd signal with this value. This can be usefull to give the xmcd more or less weight during fitting e.g.’cx20’ or ‘cx0.1’</li>
<li>’lL’, ‘cL’, ‘sL’, ‘xL’, ‘cLx&lt;xfactor&gt;’, - as before, but instead of the corresponding reflectivities themselfs their logarithms are stored and simulated. This is usefull for fitting as with the logarithm the errors of different data points are weighted in a comparable way, in spite of the strongly decaying intensitiy for higher angles (see J.Pyhs.: Condens. Matter 26 (2014) 363201, page 16).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="Experiment.ReflDataSimulator.createLinereader">
<em class="property">static </em><code class="descname">createLinereader</code><span class="sig-paren">(</span><em>energy_column=None</em>, <em>angle_column=None</em>, <em>rsigma_angle_column=None</em>, <em>rsigma_column=None</em>, <em>rpi_angle_column=None</em>, <em>rpi_column=None</em>, <em>rleft_angle_column=None</em>, <em>rleft_column=None</em>, <em>rright_angle_column=None</em>, <em>rright_column=None</em>, <em>xmcd_angle_column=None</em>, <em>xmcd_column=None</em>, <em>total_angle_column=None</em>, <em>total_column=None</em>, <em>commentsymbol='#'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/Experiment.html#ReflDataSimulator.createLinereader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#Experiment.ReflDataSimulator.createLinereader" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a linereader function which can read lines from whitespace-seperated files and returns a datapoint, which is a lists of real numbers <em>[energy,angle,rsigma,rpi,rleft,rright,xmcd,sum]</em> (or <em>None</em> for a uncommented line).
Values can also be <em>None</em>.
The linereader function returns a list of datapoints if several angles are defined within one line.</p>
<p>With the parameters <em>…_column</em> you can determin wich column is interpreted how.
Instead of one angle for all reflectivities within one line (<strong>angle_column</strong>), one can also define columns for angles which are specifically for one reflectivity polarization.
Column numbers are starting from 0.</p>
</dd></dl>

<dl class="attribute">
<dt id="Experiment.ReflDataSimulator.mode">
<code class="descname">mode</code><a class="headerlink" href="#Experiment.ReflDataSimulator.mode" title="Permalink to this definition">¶</a></dt>
<dd><p>The current mode. See <a class="reference internal" href="#Experiment.ReflDataSimulator.__init__" title="Experiment.ReflDataSimulator.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a> for possible modes. Read-only.</p>
</dd></dl>

<dl class="attribute">
<dt id="Experiment.ReflDataSimulator.hcfactor">
<code class="descname">hcfactor</code><a class="headerlink" href="#Experiment.ReflDataSimulator.hcfactor" title="Permalink to this definition">¶</a></dt>
<dd><p>Planck constant times the speed of light in units of <em>eV</em> times the unit of length which was defined by <strong>length_scale</strong> with <a class="reference internal" href="#Experiment.ReflDataSimulator.__init__" title="Experiment.ReflDataSimulator.__init__"><code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code></a>. Read-only.
BEWARE: It is <em>h</em> times <em>c</em> not <em>h_bar</em> times <em>c</em>.</p>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="fitters.html" title="Module Fitters"
             >next</a> |</li>
        <li class="right" >
          <a href="samplerepresentation.html" title="Module SampleRepresentation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PyXMRTool 0.9 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" >API</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Yannic Utz.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>